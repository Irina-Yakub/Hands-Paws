<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Log in</title>
<link rel="stylesheet" href="CSS/reset.css">
<link rel="stylesheet" href="CSS/login.css">
<link rel="stylesheet" href="CSS/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
</head>
<body>
    <div class="main">
            <a href="/"><img src="/HTML/img/home.png"  class="home" alt=""></a>
            <div class="header">АВТОРИЗАЦІЯ</div>
        <div class="blok-center">
            <p id="logo"><img src="/HTML/img/logo_blue.svg" ></p>
            <div class="center">
            <form action="" class="tabcontent" method="POST" >
                <p>Пошта:</p>
                    <input class="input" type="email" name="mailRef" type="text"   placeholder="E-mail"/></p>
                <p>Пароль:</p>
                    <input class="input" type="password" name="passRef" placeholder="Пароль" required>
                <div class="border-gradient1">
                    <p><input type="submit" id="submit" value="Увійти" name="save"  /></p>
                </div>
            </form>
            </div> 
        </div>   
    </div>
</body>
<script>
(() => {
const form = document.getElementsByTagName('form')[0]
form.addEventListener('submit', login)

async function login(event) {
    event.preventDefault()
    const res = await fetch('/api/login', 
        {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(collectData())
        })
      
    const contentType = res.headers.get("content-type")
    if (contentType && contentType.indexOf("application/json") !== -1) {
        const json = await res.json()
        console.log(json)
        return
    }

    document.location = 'http://localhost:3000'
}

function collectData() {    
    const email = document.getElementsByName('mailRef')[0].value
    const password = document.getElementsByName('passRef')[0].value
    return { email, password }
}
})()
</script>
</html>